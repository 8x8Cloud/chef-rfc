<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable = no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/foundation-essential/6.2.2/css/foundation.min.css">
    <style>
      a { color: #f18b21; }
      a:hover, a:focus { color: #3f5364; }
    </style>
    <title>Chef RFCs</title>
  </head>
  <body>
    <div class="row medium-12 columns">
      <header class="clearfix">
        <div class="left">
          <a href="/chef-rfc"><h1>Chef RFCs</h1></a>
        </div>
      </header>
<h1>Audit Segment</h1>

<p>Support audit and compliance checks in a technology agnostic way.</p>

<h2>Motivation</h2>
<div class="highlight"><pre><span class="vg">As</span><span class="w"> </span><span class="vg">a</span><span class="w"> </span><span class="vg">cookbook</span><span class="w"> </span><span class="vg">author</span><span class="p">,</span>
<span class="vg">I</span><span class="w"> </span><span class="vg">want</span><span class="w"> </span><span class="vg">to</span><span class="w"> </span><span class="vg">ship</span><span class="w"> </span><span class="vg">custom</span><span class="w"> </span><span class="vg">controls</span><span class="p">,</span>
<span class="vg">so</span><span class="w"> </span><span class="vg">that</span><span class="w"> </span><span class="vg">I</span><span class="w"> </span><span class="vg">can</span><span class="w"> </span><span class="vg">ensure</span><span class="w"> </span><span class="vg">my</span><span class="w"> </span><span class="vg">nodes</span><span class="w"> </span><span class="vg">are</span><span class="w"> </span><span class="vg">compliant</span><span class="o">.</span>

<span class="vg">As</span><span class="w"> </span><span class="vg">a</span><span class="w"> </span><span class="vg">cookbook</span><span class="w"> </span><span class="vg">author</span><span class="p">,</span>
<span class="vg">I</span><span class="w"> </span><span class="vg">want</span><span class="w"> </span><span class="vg">to</span><span class="w"> </span><span class="vg">use</span><span class="w"> </span><span class="vg">the</span><span class="w"> </span><span class="vg">most</span><span class="w"> </span><span class="vg">suitable</span><span class="w"> </span><span class="vg">compliance</span><span class="w"> </span><span class="vg">library</span><span class="p">,</span>
<span class="vg">so</span><span class="w"> </span><span class="vg">that</span><span class="w"> </span><span class="vg">I</span><span class="w"> </span><span class="vg">can</span><span class="w"> </span><span class="vg">write</span><span class="w"> </span><span class="vg">controls</span><span class="w"> </span><span class="vg">effectively</span><span class="o">.</span>

<span class="vg">As</span><span class="w"> </span><span class="vg">an</span><span class="w"> </span><span class="vg">operator</span><span class="p">,</span>
<span class="vg">I</span><span class="w"> </span><span class="vg">want</span><span class="w"> </span><span class="vg">to</span><span class="w"> </span><span class="vg">ensure</span><span class="w"> </span><span class="vg">that</span><span class="w"> </span><span class="vg">my</span><span class="w"> </span><span class="vg">converge</span><span class="w"> </span><span class="vg">happens</span><span class="w"> </span><span class="vg">separately</span><span class="w"> </span><span class="vg">from</span><span class="w"> </span><span class="vg">my</span><span class="w"> </span><span class="vg">audit</span><span class="p">,</span>
<span class="vg">so</span><span class="w"> </span><span class="vg">that</span><span class="w"> </span><span class="vg">I</span><span class="w"> </span><span class="vg">have</span><span class="w"> </span><span class="vg">full</span><span class="w"> </span><span class="vg">control</span><span class="w"> </span><span class="vg">over</span><span class="w"> </span><span class="vg">my</span><span class="w"> </span><span class="vg">runs</span><span class="o">.</span>
</pre></div>
<h2>Specification</h2>

<p>As per RFC-35, audits will be run in the <code>audit</code> phase, which occurs
after the <code>converge</code> phase completes.</p>

<p>An audit handler will be introduced to allow cookbooks to register for
the audit phase.</p>

<p>The current, serverspec based audit mode will be migrated to a cookbook
and removed from the chef-client.</p>

<p>A cookbook may depend on other gems in the usual manner to provide
functionality to audit tests.</p>

<p>Tools will be updated to upload the <code>tests</code> directory to both
supermarket and chef server. Audits can then be used both at development
time with test kitchen and similar tools, and with audit mode.</p>

<h2>Copyright</h2>

<p>This work is in the public domain. In jurisdictions that do not allow for this,
this work is available under CC0. To the extent possible under law, the person
who associated CC0 with this work has waived all copyright and related or
neighboring rights to this work.</p>
    </div>
  </body>
</html>
